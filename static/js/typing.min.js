// typing.min.js - Lightweight Typing Animation Library
class TypeWriter {
    constructor(element, options = {}) {
        this.element = typeof element === 'string' ? document.querySelector(element) : element;
        this.text = this.element.textContent || this.element.innerHTML;
        this.speed = options.speed || 50;
        this.delay = options.delay || 1000;
        this.loop = options.loop || false;
        this.cursor = options.cursor !== false;
        this.cursorChar = options.cursorChar || '|';
        this.deleteSpeed = options.deleteSpeed || 30;
        this.init();
    }

    init() {
        this.element.textContent = '';
        this.cursorElement = this.createCursor();
        if (this.cursor) this.element.appendChild(this.cursorElement);
        setTimeout(() => this.type(), this.delay);
    }

    createCursor() {
        const cursor = document.createElement('span');
        cursor.className = 'typewriter-cursor';
        cursor.textContent = this.cursorChar;
        cursor.style.animation = 'blink 1s infinite';
        return cursor;
    }

    async type() {
        const text = this.text;
        for (let i = 0; i < text.length; i++) {
            this.element.insertBefore(document.createTextNode(text[i]), this.cursorElement);
            await this.wait(this.speed);
        }
        if (this.loop) setTimeout(() => this.delete(), this.delay);
    }

    async delete() {
        const text = this.element.childNodes;
        for (let i = text.length - 2; i >= 0; i--) {
            if (text[i].nodeType === 3) {
                this.element.removeChild(text[i]);
                await this.wait(this.deleteSpeed);
            }
        }
        setTimeout(() => this.type(), this.delay);
    }

    wait(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
}

// Auto-initialize elements with data-typewriter attribute
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('[data-typewriter]').forEach(el => {
        const options = {
            speed: parseInt(el.dataset.speed) || 50,
            delay: parseInt(el.dataset.delay) || 1000,
            loop: el.dataset.loop === 'true',
            cursor: el.dataset.cursor !== 'false',
            cursorChar: el.dataset.cursorChar || '|',
            deleteSpeed: parseInt(el.dataset.deleteSpeed) || 30
        };
        new TypeWriter(el, options);
    });
});

// Global initialization function
window.initTypeWriter = function(selector, options = {}) {
    const elements = document.querySelectorAll(selector);
    elements.forEach(el => new TypeWriter(el, options));
};

// Add blink animation
const style = document.createElement('style');
style.textContent = `
    .typewriter-cursor {
        animation: blink 1s infinite;
    }
    @keyframes blink {
        0%, 50% { opacity: 1; }
        51%, 100% { opacity: 0; }
    }
`;
document.head.appendChild(style);

// Initialize single element
const writer = new TypeWriter('#heading', {
    speed: 50,
    delay: 1000,
    loop: true,
    cursor: true
});

// Initialize multiple elements
initTypeWriter('.type-animation', {
    speed: 30,
    delay: 500
});

// Multiple texts with different speeds
const texts = [
    "Quality Education",
    "Modern Facilities", 
    "Community Focus"
];

let currentIndex = 0;
const element = document.getElementById('changing-text');

function typeNext() {
    const writer = new TypeWriter(element, {
        text: texts[currentIndex],
        speed: 60,
        delay: 500,
        loop: false,
        cursor: true
    });
    
    currentIndex = (currentIndex + 1) % texts.length;
    setTimeout(typeNext, texts[currentIndex].length * 60 + 1500);
}

typeNext();